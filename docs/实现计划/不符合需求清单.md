# 设计文档不符合需求清单（对照 HR_AI_SaaS 需求清单）

> 依据文件：
> - `docs/HR_AI_SaaS需求清单.xlsx`
> - `docs/实现计划/00-总体规划.md`
> - `docs/实现计划/05-Phase5-AI能力中心.md`

---

## 1) RQ0062-0072 编号映射与模块归属不一致

**需求清单（页面级需求）摘录**（命令输出）：

```text
RQ0062 M09 报表与分析 考勤汇总报表 PageID PG0062 Page 筛选区(组织/日期/状态)；图表(可选)；明细表
RQ0063 M09 报表与分析 薪资汇总报表(可选) PageID PG0063 Page 筛选区(组织/日期/状态)；图表(可选)；明细表
RQ0064 M09 报表与分析 分析看板 PageID PG0064 Page 指标卡片；趋势图；结构分布；下钻入口
RQ0065 M09 报表与分析 自定义报表(可选增强) PageID PG0065 Page 维度选择；指标选择；筛选条件；预览
RQ0066 M10 AI 能力中心 AI 对话助手 PageID PG0066 Page 左侧会话列表；右侧对话区；引用数据卡片；推荐问题
RQ0067 M10 AI 能力中心 团队概览总结 PageID PG0067 Page 选择组织/时间；自动生成摘要；关键指标列表；引用数据
RQ0068 M10 AI 能力中心 稳定性/组织健康度分析 PageID PG0068 Page 风险提示区；原因解释；对比图；建议动作区
RQ0069 M10 AI 能力中心 AI 建议与行动 PageID PG0069 Page 建议列表；筛选(组织/类型/状态)；影响摘要
RQ0070 M10 AI 能力中心 AI 输出留痕与可解释性 PageID PG0070 Page 查询(用户/时间/场景)；输出内容；引用数据快照；用户反馈
RQ0071 M10 AI 能力中心 离职风险(解释型)+What-if PageID PG0071 Page 风险分布；高风险名单；原因维度；趋势变化
RQ0072 M10 AI 能力中心 What-if 模拟 PageID PG0072 Page 选择场景(不招聘/加编/调岗)；输入参数；输出影响对比
```

**设计文档（Phase5）摘录**（`docs/实现计划/05-Phase5-AI能力中心.md`）：

```text
| RQ0062 | AI助手 | /ai/chat | AI对话界面 |
| RQ0063 | 团队洞察 | /ai/insights/team | 团队概览 |
| RQ0064 | 离职风险 | /ai/insights/turnover | 离职风险预测 |
| RQ0065 | 组织健康 | /ai/insights/org-health | 组织健康度分析 |
| RQ0066 | 建议池 | /ai/suggestions | AI建议管理 |
| RQ0067 | What-if模拟 | /ai/whatif | 模拟分析工具 |
| RQ0068 | AI审计 | /ai/audit | 输出审计日志 |
| RQ0069 | 行动管理 | /ai/actions | AI行动跟踪 |
| RQ0070 | AI设置 | /ai/settings | AI配置管理 |
...
| RQ0071 | 报表中心 | /reports | 报表列表 |
| RQ0072 | 报表查看 | /reports/:code | 报表详情 |
```

**结论**：Phase5 文档将 RQ0062-0070 归为 AI 页面、RQ0071-0072 归为报表页面，与需求清单中 RQ0062-0065=报表、RQ0066-0072=AI 的归属不一致。

---

## 2) 设计文档包含超出需求清单的页面（RQ0073-0077）

**需求清单范围**（命令输出）：

```text
PAGE_REQ_COUNT 72
PAGE_REQ_MAX RQ0072
```

**设计文档（Phase5）摘录**（`docs/实现计划/05-Phase5-AI能力中心.md`）：

```text
| RQ0073 | 报表配置 | /reports/:code/config | 报表编辑 |
| RQ0074 | 看板中心 | /dashboards | 看板列表 |
| RQ0075 | 看板查看 | /dashboards/:id | 看板展示 |
| RQ0076 | 看板编辑 | /dashboards/:id/edit | 看板配置 |
| RQ0077 | HR驾驶舱 | /dashboards/hr | HR综合看板 |
```

**结论**：需求清单最大编号为 RQ0072，但设计文档新增了 RQ0073-0077，超出需求范围。

---

## 3) 页面数量统计不一致（72 vs 77）

**需求清单数量**（命令输出）：

```text
PAGE_REQ_COUNT 72
```

**设计文档（总体规划）摘录**（`docs/实现计划/00-总体规划.md`）：

```text
- 72个页面需求
...
| **总计** | - | **47张** | **36个** | **59个** | **77个** |
```

**结论**：同一文档内出现 72 与 77 两种页面数量口径，与需求清单 72 不一致。

---

## 4) 状态机对象数量与范围不一致（10 vs 8）

**需求清单（状态机）摘录**（命令输出）：

```text
STATE_MACHINE_OBJECTS 10
AIAction(建议动作)
Candidate(候选人)
EmploymentEvent(任职事件)
JobRequisition(招聘需求)
LeaveRequest(请假)
OnboardingTask(入职任务)
OvertimeRequest(加班)
PayrollRun(算薪批次)
PerformanceCycle(绩效周期)
Ticket(HR工单)
```

**设计文档（总体规划）摘录**（`docs/实现计划/00-总体规划.md`）：

```text
- 8种状态机
...
| EmploymentEvent | draft→pending→approved/rejected→effective | EmploymentEventStateMachine | M02 |
| JobRequisition | draft→pending→open→paused/closed | JobRequisitionStateMachine | M03 |
| Candidate | new→screening→interviewing→offering→onboarded | CandidateStateMachine | M03 |
| LeaveRequest | draft→pending→approved/rejected | LeaveRequestStateMachine | M05 |
| PayrollRun | draft→calculating→reviewing→paid | PayrollRunStateMachine | M06 |
| PerformanceCycle | not_started→in_progress→completed | PerformanceCycleStateMachine | M07 |
| Ticket | new→assigned→in_progress→resolved→closed | TicketStateMachine | M08 |
| AIAction | generated→adopted→executed | AIActionStateMachine | M10 |
```

**结论**：需求清单包含 `OnboardingTask` 与 `OvertimeRequest` 两个状态机对象，但总体规划未覆盖，且总数标为 8。

**补充证据（实现计划覆盖情况）**：

```text
docs/实现计划/06-Phase6-模块联动.md:685:| OvertimeRequest | 4 | 4 | OvertimeRequestStateMachine |
docs/实现计划/03-Phase3-考勤薪酬.md:435:│   │   └── OvertimeRequestStateMachine.java
docs/实现计划/08-后端包结构.md:257:│   │   └── OvertimeRequestStateMachine.java
```

```text
(未检索到入职任务状态机类)
```

---

## 5) 页面字段表 PageID 未在实现计划中对齐

**需求清单（页面字段表）统计**（命令输出）：

```text
PAGEID_COUNT 58
```

**实现计划检索结果**（排除本文件）：

```text
FOUND_PG 0
```

**结论**：需求清单中 58 个 PageID 未在实现计划文档中出现，页面字段表与实现计划缺少显式对齐。

---

## 6) 按钮字典 BTN 未在实现计划中对齐

**需求清单（按钮字典）统计**（命令输出）：

```text
BTN_COUNT 285
```

**实现计划检索结果**（排除本文件）：

```text
FOUND_BTN 0
```

**结论**：需求清单中 285 个按钮 ID 未在实现计划文档中出现，按钮级操作与实现计划缺少显式对齐。

---

## 7) 异常场景 EX 未在实现计划中对齐

**需求清单（异常场景）统计**（命令输出）：

```text
EX_COUNT 25
```

**实现计划检索结果**（排除本文件）：

```text
FOUND_EX 0
```

**结论**：需求清单中 25 个异常场景 ID 未在实现计划文档中出现，异常处理与实现计划缺少显式对齐。
