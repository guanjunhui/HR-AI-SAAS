# 数据库表清单

> 全部 47 张业务表 + 12 张 Agent 基础表

## 表清单总览

### 已存在的 Agent 基础表（12张）

| 序号 | 表名 | 说明 | 所属模块 |
|------|------|------|----------|
| A01 | agents | Agent定义表 | Agent编排 |
| A02 | workflows | 工作流定义表 | Agent编排 |
| A03 | workflow_executions | 工作流执行记录表 | Agent编排 |
| A04 | user_profiles | 用户画像表 | 记忆管理 |
| A05 | conversation_history | 对话历史表 | 记忆管理 |
| A06 | functions | Function定义表 | 工具调用 |
| A07 | function_invocations | Function调用日志表 | 工具调用 |
| A08 | knowledge_docs | 知识库文档表 | 知识库 |
| A09 | knowledge_chunks | 文档分块表 | 知识库 |
| A10 | tenants | 租户配置表 | 租户管理 |
| A11 | token_usage | Token使用记录表 | 成本管理 |

### Phase 1: 基础业务模块（11张）

| 序号 | 表名 | 说明 | 所属模块 |
|------|------|------|----------|
| 01 | org_units | 组织单元表 | M01 组织与权限 |
| 02 | sys_users | 系统用户表 | M01 组织与权限 |
| 03 | sys_roles | 角色表 | M01 组织与权限 |
| 04 | sys_user_roles | 用户角色关联表 | M01 组织与权限 |
| 05 | sys_role_permissions | 角色权限表 | M01 组织与权限 |
| 06 | audit_logs | 审计日志表 | M01 组织与权限 |
| 07 | positions | 岗位表 | M02 Core HR |
| 08 | headcounts | 编制配置表 | M02 Core HR |
| 09 | employees | 员工表 | M02 Core HR |
| 10 | employee_details | 员工详细信息表 | M02 Core HR |
| 11 | employment_events | 人事事件表 | M02 Core HR |

### Phase 2: 招聘与入职（9张）

| 序号 | 表名 | 说明 | 所属模块 |
|------|------|------|----------|
| 12 | job_requisitions | 招聘需求表 | M03 招聘管理 |
| 13 | candidates | 候选人表 | M03 招聘管理 |
| 14 | candidate_resumes | 候选人简历表 | M03 招聘管理 |
| 15 | candidate_applications | 候选人应聘记录表 | M03 招聘管理 |
| 16 | interviews | 面试表 | M03 招聘管理 |
| 17 | interview_feedbacks | 面试反馈表 | M03 招聘管理 |
| 18 | offers | Offer表 | M03 招聘管理 |
| 19 | onboardings | 入职记录表 | M04 入职Onboarding |
| 20 | onboarding_materials | 入职资料表 | M04 入职Onboarding |

### Phase 3: 考勤薪酬（12张）

| 序号 | 表名 | 说明 | 所属模块 |
|------|------|------|----------|
| 21 | attendance_shifts | 班次表 | M05 考勤假勤 |
| 22 | attendance_rules | 考勤规则表 | M05 考勤假勤 |
| 23 | attendance_records | 打卡记录表 | M05 考勤假勤 |
| 24 | leave_types | 假期类型表 | M05 考勤假勤 |
| 25 | leave_balances | 假期余额表 | M05 考勤假勤 |
| 26 | leave_requests | 请假申请表 | M05 考勤假勤 |
| 27 | salary_items | 薪酬项目表 | M06 薪酬薪资 |
| 28 | salary_archives | 员工薪资档案表 | M06 薪酬薪资 |
| 29 | payroll_runs | 算薪批次表 | M06 薪酬薪资 |
| 30 | payroll_details | 薪资明细表 | M06 薪酬薪资 |
| 31 | payslips | 工资条表 | M06 薪酬薪资 |
| 32 | overtime_requests | 加班申请表 | M05 考勤假勤 |

### Phase 4: 绩效与员工关系（8张）

| 序号 | 表名 | 说明 | 所属模块 |
|------|------|------|----------|
| 33 | performance_cycles | 绩效周期表 | M07 绩效管理 |
| 34 | performance_goals | 绩效目标表 | M07 绩效管理 |
| 35 | performance_reviews | 绩效评估表 | M07 绩效管理 |
| 36 | performance_results | 绩效结果表 | M07 绩效管理 |
| 37 | ticket_types | 工单类型表 | M08 工单系统 |
| 38 | tickets | 工单表 | M08 工单系统 |
| 39 | ticket_comments | 工单评论表 | M08 工单系统 |
| 40 | knowledge_articles | 知识库文章表 | M08 工单系统 |

### Phase 5: AI能力中心与报表（7张）

| 序号 | 表名 | 说明 | 所属模块 |
|------|------|------|----------|
| 41 | ai_suggestions | AI建议表 | M10 AI能力中心 |
| 42 | ai_actions | AI行动表 | M10 AI能力中心 |
| 43 | ai_audit_logs | AI输出审计日志表 | M10 AI能力中心 |
| 44 | whatif_simulations | What-if模拟记录表 | M10 AI能力中心 |
| 45 | onboarding_tasks | 入职任务表 | M04 入职Onboarding(补充) |
| 46 | report_configs | 报表配置表 | M09 报表与分析 |
| 47 | dashboard_configs | 看板配置表 | M09 报表与分析 |

---

## 完整 DDL 脚本

### Phase 1 表结构

```sql
-- ============================================
-- Phase 1: 基础业务模块 (11张表)
-- ============================================

-- 1. 组织单元表
CREATE TABLE org_units (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    parent_id BIGINT DEFAULT 0 COMMENT '父级ID，0表示顶级',
    unit_code VARCHAR(50) NOT NULL COMMENT '组织编码',
    unit_name VARCHAR(100) NOT NULL COMMENT '组织名称',
    unit_type VARCHAR(20) COMMENT '类型：company-公司/dept-部门/team-团队',
    manager_id BIGINT COMMENT '负责人ID',
    sort_order INT DEFAULT 0 COMMENT '排序号',
    status TINYINT DEFAULT 1 COMMENT '状态：1-启用/0-禁用',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除：0-正常/1-删除',
    INDEX idx_tenant_parent (tenant_id, parent_id),
    UNIQUE KEY uk_tenant_code (tenant_id, unit_code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='组织单元表';

-- 2. 系统用户表
CREATE TABLE sys_users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    user_code VARCHAR(50) NOT NULL COMMENT '工号',
    username VARCHAR(50) NOT NULL COMMENT '登录名',
    password VARCHAR(255) NOT NULL COMMENT '密码(BCrypt加密)',
    real_name VARCHAR(50) COMMENT '真实姓名',
    email VARCHAR(100) COMMENT '邮箱',
    phone VARCHAR(20) COMMENT '手机号',
    avatar_url VARCHAR(255) COMMENT '头像URL',
    org_unit_id BIGINT COMMENT '所属组织ID',
    status TINYINT DEFAULT 1 COMMENT '状态：1-启用/0-禁用',
    last_login_at TIMESTAMP COMMENT '最后登录时间',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    UNIQUE KEY uk_tenant_username (tenant_id, username),
    INDEX idx_org_unit (org_unit_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统用户表';

-- 3. 角色表
CREATE TABLE sys_roles (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    role_code VARCHAR(50) NOT NULL COMMENT '角色编码',
    role_name VARCHAR(100) NOT NULL COMMENT '角色名称',
    description TEXT COMMENT '角色描述',
    data_scope TINYINT DEFAULT 1 COMMENT '数据范围：1-全部/2-本部门/3-本人',
    status TINYINT DEFAULT 1 COMMENT '状态：1-启用/0-禁用',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    UNIQUE KEY uk_tenant_code (tenant_id, role_code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色表';

-- 4. 用户角色关联表
CREATE TABLE sys_user_roles (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    user_id BIGINT NOT NULL COMMENT '用户ID',
    role_id BIGINT NOT NULL COMMENT '角色ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    UNIQUE KEY uk_user_role (user_id, role_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户角色关联表';

-- 5. 角色权限表
CREATE TABLE sys_role_permissions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    role_id BIGINT NOT NULL COMMENT '角色ID',
    permission_code VARCHAR(100) NOT NULL COMMENT '权限编码',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    INDEX idx_role (role_id),
    UNIQUE KEY uk_role_permission (role_id, permission_code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色权限表';

-- 6. 审计日志表
CREATE TABLE audit_logs (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    user_id BIGINT COMMENT '操作用户ID',
    user_name VARCHAR(50) COMMENT '操作用户名',
    module VARCHAR(50) COMMENT '模块名',
    action VARCHAR(50) COMMENT '操作类型',
    target_type VARCHAR(50) COMMENT '目标类型',
    target_id VARCHAR(64) COMMENT '目标ID',
    before_data JSON COMMENT '操作前数据',
    after_data JSON COMMENT '操作后数据',
    ip_address VARCHAR(50) COMMENT 'IP地址',
    user_agent VARCHAR(255) COMMENT '用户代理',
    result TINYINT COMMENT '结果：1-成功/0-失败',
    error_msg TEXT COMMENT '错误信息',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    INDEX idx_tenant_time (tenant_id, created_at),
    INDEX idx_user (user_id),
    INDEX idx_module (module)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='审计日志表';

-- 7. 岗位表
CREATE TABLE positions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    position_code VARCHAR(50) NOT NULL COMMENT '岗位编码',
    position_name VARCHAR(100) NOT NULL COMMENT '岗位名称',
    position_level INT COMMENT '职级',
    job_family VARCHAR(50) COMMENT '职族：tech-技术/sales-销售/support-支持/management-管理',
    org_unit_id BIGINT COMMENT '所属部门ID',
    description TEXT COMMENT '岗位描述',
    requirements TEXT COMMENT '任职要求',
    status TINYINT DEFAULT 1 COMMENT '状态：1-启用/0-禁用',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    UNIQUE KEY uk_tenant_code (tenant_id, position_code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='岗位表';

-- 8. 编制配置表
CREATE TABLE headcounts (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    org_unit_id BIGINT NOT NULL COMMENT '部门ID',
    position_id BIGINT NOT NULL COMMENT '岗位ID',
    budget_count INT NOT NULL COMMENT '编制数',
    current_count INT DEFAULT 0 COMMENT '在编人数',
    effective_date DATE COMMENT '生效日期',
    expire_date DATE COMMENT '失效日期',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_org_position (org_unit_id, position_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='编制配置表';

-- 9. 员工表
CREATE TABLE employees (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    employee_code VARCHAR(50) NOT NULL COMMENT '工号',
    sys_user_id BIGINT COMMENT '关联系统用户ID',
    real_name VARCHAR(50) NOT NULL COMMENT '姓名',
    gender TINYINT COMMENT '性别：1-男/2-女',
    birth_date DATE COMMENT '出生日期',
    id_card VARCHAR(20) COMMENT '身份证号',
    phone VARCHAR(20) COMMENT '手机号',
    email VARCHAR(100) COMMENT '邮箱',
    org_unit_id BIGINT COMMENT '所属部门ID',
    position_id BIGINT COMMENT '岗位ID',
    direct_manager_id BIGINT COMMENT '直属上级ID',
    entry_date DATE COMMENT '入职日期',
    regularization_date DATE COMMENT '转正日期',
    contract_start DATE COMMENT '合同开始日期',
    contract_end DATE COMMENT '合同结束日期',
    employee_status VARCHAR(20) DEFAULT 'trial' COMMENT '状态：trial-试用期/regular-正式/resigned-离职',
    work_location VARCHAR(100) COMMENT '工作地点',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    UNIQUE KEY uk_tenant_code (tenant_id, employee_code),
    INDEX idx_org_unit (org_unit_id),
    INDEX idx_status (employee_status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='员工表';

-- 10. 员工详细信息表
CREATE TABLE employee_details (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    employee_id BIGINT NOT NULL COMMENT '员工ID',
    highest_education VARCHAR(20) COMMENT '最高学历：high_school/bachelor/master/doctor',
    graduate_school VARCHAR(100) COMMENT '毕业院校',
    major VARCHAR(100) COMMENT '专业',
    emergency_contact VARCHAR(50) COMMENT '紧急联系人',
    emergency_phone VARCHAR(20) COMMENT '紧急联系人电话',
    emergency_relation VARCHAR(20) COMMENT '与紧急联系人关系',
    bank_name VARCHAR(50) COMMENT '开户银行',
    bank_account VARCHAR(50) COMMENT '银行账号',
    current_address TEXT COMMENT '现居住地址',
    household_address TEXT COMMENT '户籍地址',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    UNIQUE KEY uk_employee (employee_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='员工详细信息表';

-- 11. 人事事件表
CREATE TABLE employment_events (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    event_code VARCHAR(64) NOT NULL UNIQUE COMMENT '事件编号',
    event_type VARCHAR(20) NOT NULL COMMENT '类型：onboard-入职/regularize-转正/transfer-调岗/salary_change-调薪/resign-离职',
    employee_id BIGINT COMMENT '员工ID(入职时为空)',
    status VARCHAR(20) DEFAULT 'draft' COMMENT '状态：draft-草稿/pending-审批中/approved-已通过/rejected-已驳回/withdrawn-已撤回',
    applicant_id BIGINT COMMENT '申请人ID',
    apply_date DATE COMMENT '申请日期',
    effective_date DATE COMMENT '生效日期',
    change_content JSON COMMENT '变更内容(JSON)',
    approver_ids JSON COMMENT '审批人列表(JSON数组)',
    current_approver_id BIGINT COMMENT '当前审批人ID',
    approve_records JSON COMMENT '审批记录(JSON数组)',
    attachments JSON COMMENT '附件列表(JSON数组)',
    remark TEXT COMMENT '备注',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_tenant_type (tenant_id, event_type),
    INDEX idx_employee (employee_id),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='人事事件表';
```

### Phase 2 表结构

```sql
-- ============================================
-- Phase 2: 招聘与入职 (9张表)
-- ============================================

-- 12. 招聘需求表
CREATE TABLE job_requisitions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    req_code VARCHAR(64) NOT NULL UNIQUE COMMENT '需求编号',
    position_id BIGINT NOT NULL COMMENT '岗位ID',
    org_unit_id BIGINT NOT NULL COMMENT '招聘部门ID',
    headcount INT NOT NULL COMMENT '招聘人数',
    job_title VARCHAR(100) COMMENT '职位名称',
    job_description TEXT COMMENT '职位描述',
    requirements TEXT COMMENT '任职要求',
    salary_range_min INT COMMENT '薪资范围-最低',
    salary_range_max INT COMMENT '薪资范围-最高',
    work_location VARCHAR(100) COMMENT '工作地点',
    status VARCHAR(20) DEFAULT 'draft' COMMENT '状态：draft/pending_approval/open/paused/closed',
    applicant_id BIGINT COMMENT '申请人ID',
    apply_date DATE COMMENT '申请日期',
    approver_id BIGINT COMMENT '审批人ID',
    approve_date DATE COMMENT '审批日期',
    applied_count INT DEFAULT 0 COMMENT '已投递数',
    interviewed_count INT DEFAULT 0 COMMENT '已面试数',
    offered_count INT DEFAULT 0 COMMENT '已发Offer数',
    hired_count INT DEFAULT 0 COMMENT '已录用数',
    urgency VARCHAR(10) DEFAULT 'normal' COMMENT '紧急程度：urgent/normal/low',
    expected_onboard_date DATE COMMENT '期望到岗日期',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_tenant_status (tenant_id, status),
    INDEX idx_org_unit (org_unit_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='招聘需求表';

-- 13. 候选人表
CREATE TABLE candidates (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    candidate_code VARCHAR(64) NOT NULL UNIQUE COMMENT '候选人编号',
    name VARCHAR(50) NOT NULL COMMENT '姓名',
    gender TINYINT COMMENT '性别：1-男/2-女',
    phone VARCHAR(20) COMMENT '手机号',
    email VARCHAR(100) COMMENT '邮箱',
    source VARCHAR(50) COMMENT '来源：internal_referral/headhunter/job_site/campus/direct',
    referrer_id BIGINT COMMENT '内推人ID',
    headhunter_name VARCHAR(50) COMMENT '猎头名称',
    status VARCHAR(20) DEFAULT 'new' COMMENT '状态：new/screening/interviewing/offering/pending_onboard/onboarded/rejected',
    current_req_id BIGINT COMMENT '当前关联的招聘需求ID',
    tags JSON COMMENT '标签(JSON数组)',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_tenant_status (tenant_id, status),
    INDEX idx_phone (phone),
    INDEX idx_email (email)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='候选人表';

-- 14. 候选人简历表
CREATE TABLE candidate_resumes (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    candidate_id BIGINT NOT NULL COMMENT '候选人ID',
    educations JSON COMMENT '教育经历(JSON数组)',
    experiences JSON COMMENT '工作经历(JSON数组)',
    skills JSON COMMENT '技能标签(JSON数组)',
    expected_salary INT COMMENT '期望薪资',
    expected_location VARCHAR(100) COMMENT '期望工作地点',
    available_date DATE COMMENT '可到岗日期',
    resume_url VARCHAR(255) COMMENT '简历文件URL',
    ai_parsed TINYINT DEFAULT 0 COMMENT '是否AI解析过',
    ai_summary TEXT COMMENT 'AI简历摘要',
    ai_match_score DECIMAL(5,2) COMMENT 'AI匹配度评分',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    UNIQUE KEY uk_candidate (candidate_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='候选人简历表';

-- 15. 候选人应聘记录表
CREATE TABLE candidate_applications (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    candidate_id BIGINT NOT NULL COMMENT '候选人ID',
    job_req_id BIGINT NOT NULL COMMENT '招聘需求ID',
    status VARCHAR(20) DEFAULT 'applied' COMMENT '状态：applied/screening/passed/rejected',
    apply_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '投递日期',
    hr_evaluation TEXT COMMENT 'HR初评',
    hr_score INT COMMENT 'HR评分(1-5)',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_candidate (candidate_id),
    INDEX idx_job_req (job_req_id),
    UNIQUE KEY uk_candidate_req (candidate_id, job_req_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='候选人应聘记录表';

-- 16. 面试表
CREATE TABLE interviews (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    interview_code VARCHAR(64) NOT NULL UNIQUE COMMENT '面试编号',
    candidate_id BIGINT NOT NULL COMMENT '候选人ID',
    job_req_id BIGINT NOT NULL COMMENT '招聘需求ID',
    application_id BIGINT NOT NULL COMMENT '应聘记录ID',
    round INT COMMENT '面试轮次',
    interview_type VARCHAR(20) COMMENT '面试类型：phone/video/onsite/written',
    interviewer_ids JSON COMMENT '面试官ID列表(JSON数组)',
    scheduled_time TIMESTAMP COMMENT '预约时间',
    duration_minutes INT COMMENT '预计时长(分钟)',
    location VARCHAR(100) COMMENT '面试地点/会议链接',
    status VARCHAR(20) DEFAULT 'scheduled' COMMENT '状态：scheduled/in_progress/completed/cancelled/no_show',
    result VARCHAR(20) COMMENT '结果：pass/fail/pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_candidate (candidate_id),
    INDEX idx_scheduled_time (scheduled_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='面试表';

-- 17. 面试反馈表
CREATE TABLE interview_feedbacks (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    interview_id BIGINT NOT NULL COMMENT '面试ID',
    interviewer_id BIGINT NOT NULL COMMENT '面试官ID',
    overall_score INT COMMENT '总体评分(1-5)',
    skill_score INT COMMENT '技能评分(1-5)',
    culture_score INT COMMENT '文化匹配评分(1-5)',
    communication_score INT COMMENT '沟通能力评分(1-5)',
    strengths TEXT COMMENT '优势',
    weaknesses TEXT COMMENT '不足',
    recommendation VARCHAR(20) COMMENT '建议：strong_hire/hire/no_hire/strong_no_hire',
    comments TEXT COMMENT '详细评价',
    ai_generated TINYINT DEFAULT 0 COMMENT '是否AI生成',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_interview (interview_id),
    UNIQUE KEY uk_interview_interviewer (interview_id, interviewer_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='面试反馈表';

-- 18. Offer表
CREATE TABLE offers (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    offer_code VARCHAR(64) NOT NULL UNIQUE COMMENT 'Offer编号',
    candidate_id BIGINT NOT NULL COMMENT '候选人ID',
    job_req_id BIGINT NOT NULL COMMENT '招聘需求ID',
    position_id BIGINT COMMENT '岗位ID',
    org_unit_id BIGINT COMMENT '入职部门ID',
    salary_monthly INT COMMENT '月薪',
    salary_annual INT COMMENT '年薪',
    bonus_months INT COMMENT '年终奖月数',
    other_benefits TEXT COMMENT '其他福利',
    expected_onboard_date DATE COMMENT '期望入职日期',
    offer_expire_date DATE COMMENT 'Offer有效期',
    status VARCHAR(20) DEFAULT 'draft' COMMENT '状态：draft/pending_approval/approved/sent/accepted/rejected/expired',
    approver_id BIGINT COMMENT '审批人ID',
    approve_date DATE COMMENT '审批日期',
    candidate_response VARCHAR(20) COMMENT '候选人反馈：accepted/rejected/negotiating',
    response_date DATE COMMENT '反馈日期',
    reject_reason TEXT COMMENT '拒绝原因',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_candidate (candidate_id),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='Offer表';

-- 19. 入职记录表
CREATE TABLE onboardings (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    tenant_id VARCHAR(64) NOT NULL COMMENT '租户ID',
    onboarding_code VARCHAR(64) NOT NULL UNIQUE COMMENT '入职编号',
    offer_id BIGINT COMMENT '关联Offer ID',
    candidate_id BIGINT NOT NULL COMMENT '候选人ID',
    expected_date DATE COMMENT '预计入职日期',
    actual_date DATE COMMENT '实际入职日期',
    position_id BIGINT COMMENT '岗位ID',
    org_unit_id BIGINT COMMENT '入职部门ID',
    direct_manager_id BIGINT COMMENT '直属上级ID',
    status VARCHAR(20) DEFAULT 'pending' COMMENT '状态：pending/materials_collecting/materials_verified/completed/cancelled',
    employee_id BIGINT COMMENT '创建的员工ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT DEFAULT 0 COMMENT '逻辑删除',
    INDEX idx_tenant_status (tenant_id, status),
    INDEX idx_expected_date (expected_date)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='入职记录表';

-- 20. 入职资料表
CREATE TABLE onboarding_materials (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    onboarding_id BIGINT NOT NULL COMMENT '入职记录ID',
    material_type VARCHAR(50) NOT NULL COMMENT '资料类型：id_card/photo/diploma/bank_card/health_cert/contract',
    material_name VARCHAR(100) COMMENT '资料名称',
    is_required TINYINT DEFAULT 1 COMMENT '是否必须：1-是/0-否',
    file_url VARCHAR(255) COMMENT '文件URL',
    submitted TINYINT DEFAULT 0 COMMENT '是否已提交',
    submit_time TIMESTAMP COMMENT '提交时间',
    verified TINYINT DEFAULT 0 COMMENT '是否已审核',
    verify_time TIMESTAMP COMMENT '审核时间',
    verifier_id BIGINT COMMENT '审核人ID',
    remark TEXT COMMENT '备注',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_onboarding (onboarding_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='入职资料表';
```

### Phase 3-5 表结构

> 详见各阶段文档中的完整 DDL

---

## 表关系说明

### 核心关系图

```
tenants (租户)
    │
    ├── org_units (组织)
    │       │
    │       ├── employees (员工)
    │       │       │
    │       │       ├── employee_details (员工详情)
    │       │       ├── salary_archives (薪资档案)
    │       │       ├── leave_balances (假期余额)
    │       │       ├── attendance_records (考勤记录)
    │       │       ├── performance_goals (绩效目标)
    │       │       └── performance_results (绩效结果)
    │       │
    │       ├── positions (岗位)
    │       │       │
    │       │       └── headcounts (编制)
    │       │
    │       └── job_requisitions (招聘需求)
    │               │
    │               ├── candidates (候选人)
    │               │       │
    │               │       ├── candidate_resumes (简历)
    │               │       ├── candidate_applications (投递记录)
    │               │       ├── interviews (面试)
    │               │       └── offers (Offer)
    │               │               │
    │               │               └── onboardings (入职)
    │               │                       │
    │               │                       ├── onboarding_materials (资料)
    │               │                       └── onboarding_tasks (任务)
    │
    ├── sys_users (系统用户)
    │       │
    │       └── sys_user_roles ─── sys_roles (角色)
    │                                   │
    │                                   └── sys_role_permissions (权限)
    │
    ├── tickets (工单)
    │       │
    │       ├── ticket_comments (评论)
    │       └── ticket_types (类型)
    │
    ├── payroll_runs (算薪批次)
    │       │
    │       ├── payroll_details (明细)
    │       └── payslips (工资条)
    │
    ├── performance_cycles (绩效周期)
    │       │
    │       ├── performance_goals (目标)
    │       ├── performance_reviews (评估)
    │       └── performance_results (结果)
    │
    └── ai_suggestions (AI建议)
            │
            └── ai_actions (AI行动)
```

---

## 索引设计原则

1. **租户隔离索引**：所有业务表的查询都应包含 `tenant_id`
2. **状态索引**：状态流转频繁的表需要状态字段索引
3. **时间范围索引**：考勤、薪资等按时间查询的表需要时间索引
4. **外键索引**：所有外键字段都应建立索引
5. **唯一约束**：业务编码字段使用唯一索引

---

*本文档包含系统所有 47 张业务表的完整设计*
