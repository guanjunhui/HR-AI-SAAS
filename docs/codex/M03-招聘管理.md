# M03 招聘管理(ATS) - 实现方案

## 模块范围与页面
以下页面来源于需求清单，作为前后端实现的基准。

| 需求ID | PageID | 功能 | 页面类型 | 页面/区块 | 按钮/操作 | 关键字段 | 校验/规则 | 状态/口径 | 输入/输出 | 异常索引 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| RQ0021 | PG0021 | 招聘需求管理 | 列表页 | 筛选(组织/岗位/状态/渠道)；列表；统计卡片(可选) | 新建需求；编辑；提交审批；暂停/关闭；导出；查看详情 | 需求编号, 岗位, 人数, 部门, 期望到岗, 状态, 创建人 | 需求人数>0；期望到岗>=今日(可配)；关闭后不可新增候选人 | 状态：草稿/审批中/开放中/暂停/关闭/归档 | JobRequisition(读写), Position(读), OrgUnit(读) | EX0001,EX0003,EX0015 |
| RQ0022 | PG0022 | 招聘需求管理 | 创建/编辑页 | 需求表单；审批流预览；(V2)编制占用提示 | 保存草稿；提交审批；取消 | 岗位, 招聘人数, 用人部门, 期望到岗, JD, 渠道, 薪资范围(可选) | 必填校验；(V2)编制强校验；JD长度限制(可选) | — | JobRequisition(写) | EX0001,EX0003,EX0015 |
| RQ0023 | PG0023 | 招聘需求管理 | 详情页 | 需求信息；候选人列表(嵌入)；面试安排；审批记录；漏斗统计 | 编辑(草稿/驳回)；暂停/关闭；新增候选人；导出候选人 | 需求字段+候选人状态+面试安排 | 暂停/关闭需记录原因；关闭后所有未完结候选人进入结束态(规则可选) | — | JobRequisition(读写), Candidate(读写) | EX0001 |
| RQ0024 | PG0024 | 候选人管理 | 列表页(人才库/需求内列表) | 筛选(需求/状态/渠道/标签)；列表；批量操作 | 新增候选人；导入(可选)；标记淘汰；批量发起面试；导出 | 姓名, 联系方式, 来源, 目标岗位/需求, 状态, 最近推进时间, 标签 | 淘汰需原因；批量操作需权限；重复检测提示 | 候选人状态：新投递/面试中/Offer中/待入职/已入职/已淘汰 | Candidate(读写) | EX0001,EX0016 |
| RQ0025 | PG0025 | 候选人管理 | 详情页 | 基本信息/简历；应聘记录；面试记录；Offer记录；操作历史 | 推进下一阶段；安排面试；发Offer；淘汰；合并(可选)；导出简历 | 姓名, 联系方式, 简历, 经验, 标签, 状态, 关联需求 | 状态推进必须按状态机；关键动作(淘汰/Offer撤回)需原因 | — | Candidate(读写), Interview(读写), Offer(读写) | EX0001 |
| RQ0026 | PG0026 | 面试管理 | 面试安排页(需求/候选人内) | 面试轮次列表；安排表单；面评表链接 | 创建面试；修改时间；取消；发送通知(可选) | 轮次, 面试官, 时间, 形式(线上/线下), 地点/链接 | 时间冲突提示(可选)；取消需原因 | 面试状态：待进行/已完成/已取消 | Interview(读写), Candidate(读) | EX0001 |
| RQ0027 | PG0027 | Offer 管理 | 创建页 | Offer表单；审批流预览；(可选)模板预览 | 保存草稿；提交审批；发送Offer；撤回 | 候选人, 岗位, 薪资方案(简版), 入职日期, 有效期, 备注 | 入职日期>=今日；有效期必填；发送前必须审批通过 | Offer状态：草稿/审批中/已发送/已接受/已拒绝/已撤回/已过期 | Offer(读写), Candidate(读) | EX0001,EX0017 |
| RQ0028 | PG0028 | Offer 管理 | 详情页 | Offer信息；审批记录；签署状态；转入职入口 | 撤回；重发；转入职；导出Offer(可选) | Offer字段全量+记录 | 过期自动处理；转入职需校验必填资料是否齐全(可选) | — | Offer(读写), Candidate(读) | EX0001,EX0017 |

## 前端实现方案
- 路由与菜单：按 PageID 建路由与菜单分组，详情/创建页按列表页入口跳转。
- 页面结构：以需求中的“页面/区块”为信息架构，表单/表格字段由页面字段表驱动渲染。
- 按钮与权限：按钮集合以“按钮/操作”为准，按钮级权限点从按钮字典同步；字段级权限动态隐藏/脱敏。
- 交互校验：前端执行必填/格式/枚举校验，并在提交时提示后端返回的业务校验错误。
- 导入/导出：统一上传/导出组件；大结果集提示异步导出。
页面清单：
- PG0021 招聘需求管理（列表页）：筛选(组织/岗位/状态/渠道)；列表；统计卡片(可选)
- PG0022 招聘需求管理（创建/编辑页）：需求表单；审批流预览；(V2)编制占用提示
- PG0023 招聘需求管理（详情页）：需求信息；候选人列表(嵌入)；面试安排；审批记录；漏斗统计
- PG0024 候选人管理（列表页(人才库/需求内列表)）：筛选(需求/状态/渠道/标签)；列表；批量操作
- PG0025 候选人管理（详情页）：基本信息/简历；应聘记录；面试记录；Offer记录；操作历史
- PG0026 面试管理（面试安排页(需求/候选人内)）：面试轮次列表；安排表单；面评表链接
- PG0027 Offer 管理（创建页）：Offer表单；审批流预览；(可选)模板预览
- PG0028 Offer 管理（详情页）：Offer信息；审批记录；签署状态；转入职入口

## 后端实现方案
- 领域对象（建议）：JobRequisition、Candidate、Interview、Offer、Channel
- API 设计：按页面“按钮/操作”映射 CRUD/状态变更/导入导出/审批动作；列表页必须支持分页与多条件筛选。
- 校验与规则：后端强校验业务规则与并发版本（见下方“关键规则/异常”）。
- 权限与审计：RBAC + 组织范围（行级）+ 字段级权限；关键写操作写入审计日志。
- 幂等与一致性：对导入/批量操作提供幂等 token；审批/状态变更防重。

## 状态机
- JobRequisition(招聘需求)
  - 草稿 -> 审批中（操作：提交审批/删除；角色：用人经理/HR/审批人）
  - 审批中 -> 开放中/已驳回/已撤回（操作：同意/驳回/撤回；角色：用人经理/HR/审批人）
  - 开放中 -> 已关闭/已暂停（操作：关闭/暂停/发布渠道；角色：用人经理/HR/审批人）
  - 已暂停 -> 开放中（操作：恢复；角色：用人经理/HR/审批人）
  - 已关闭 -> 归档（操作：归档；角色：用人经理/HR/审批人）
- Candidate(候选人)
  - 新投递 -> 面试中/已淘汰（操作：筛选通过/淘汰；角色：HR/面试官）
  - 面试中 -> 面试中/Offer中/已淘汰（操作：推进下一轮/发Offer/淘汰；角色：HR/面试官）
  - Offer中 -> 待入职/已拒绝/已撤回（操作：Offer接受/拒绝/撤回；角色：HR/面试官）
  - 待入职 -> 已入职/已放弃（操作：转入职/放弃；角色：HR/面试官）
  - 已入职 -> —（操作：—；角色：HR/面试官）

## 模块联动
- LK0001：下游 M02 Core HR -> M03 招聘管理；触发=岗位编制调整/占用变化；读写=读写: Position编制读取, Requisition校验；规则=V2启用强校验时：需求提交需校验空缺>=需求人数
- LK0002：上游 M03 招聘管理 -> M04 入职与Onboarding；触发=Offer被接受；读写=写: OnboardingProfile/Task生成；规则=接受后生成资料收集与入职任务
- LK0006：下游 M10 AI 能力中心 -> M03 招聘管理；触发=采纳建议: 创建招聘需求；读写=写: JobRequisition；规则=执行前校验编制/权限；失败回滚

## 关键规则
- 需求人数>0；期望到岗>=今日(可配)；关闭后不可新增候选人
- 必填校验；(V2)编制强校验；JD长度限制(可选)
- 暂停/关闭需记录原因；关闭后所有未完结候选人进入结束态(规则可选)
- 淘汰需原因；批量操作需权限；重复检测提示
- 状态推进必须按状态机；关键动作(淘汰/Offer撤回)需原因
- 时间冲突提示(可选)；取消需原因
- 入职日期>=今日；有效期必填；发送前必须审批通过
- 过期自动处理；转入职需校验必填资料是否齐全(可选)

## 异常场景
- EX0001：越权访问/返回敏感字段（用户无行级或字段级权限）
- EX0003：必填字段缺失（提交时必填为空）
- EX0015：编制不足无法提交（岗位编制已满且启用强校验(V2)）
- EX0016：候选人重复（手机号/邮箱/证件号已存在且未合并）
- EX0017：Offer审批通过但未签署（候选人未在期限内接受）

## 验收与测试要点
- 状态流转符合状态机；关闭后不可推进候选人
- 提交后进入审批中；审批通过进入开放中
- 候选人漏斗与状态一致；导出遵循权限
- 筛选/状态更新正确；淘汰原因在详情可追溯
- 推进动作后状态与时间线一致；面试官只能填写面评表
- 面试完成后可提交面评；候选人状态根据结果可推进
- 审批通过后才能发送；候选人接受后进入待入职
- 接受后可一键转入职并创建入职流程/资料收集
