# M07 绩效管理 - 实现方案

## 模块范围与页面
以下页面来源于需求清单，作为前后端实现的基准。

| 需求ID | PageID | 功能 | 页面类型 | 页面/区块 | 按钮/操作 | 关键字段 | 校验/规则 | 状态/口径 | 输入/输出 | 异常索引 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| RQ0045 | PG0045 | 绩效周期管理 | 列表页 | 周期列表；状态；覆盖范围 | 新建周期；编辑；发布；关闭；导出 | 周期名, 起止日期, 状态, 覆盖组织, 评分规则(可选) | 周期不可重叠(同人群)；发布后关键参数锁定(可选) | 状态：未开始/进行中/待确认/已完成 | PerformanceCycle(读写), OrgUnit(读) | EX0001 |
| RQ0046 | PG0046 | 绩效周期管理 | 创建/编辑页 | 周期基本信息；参与范围；流程节点配置；评估表模板 | 保存；发布；取消 | 周期名, 起止日期, 范围, 节点日期, 模板 | 日期逻辑校验；范围内人员冻结快照(可选) | — | PerformanceCycle(写), ReviewTemplate(写) | EX0001,EX0003 |
| RQ0047 | PG0047 | 目标管理(KPI/OKR) | 员工端-目标列表 | 当前周期目标列表；权重合计提示；对齐关系(可选) | 新增目标；编辑；提交确认；导出(可选) | 目标名称, 指标/关键结果, 权重, 截止, 进度/结果 | 权重合计=100%(可配)；截止日期在周期内 | 目标状态：草稿/已提交/已确认 | Goal(读写), PerformanceCycle(读) | EX0001,EX0003 |
| RQ0048 | PG0048 | 目标管理(KPI/OKR) | 经理端-团队目标视图 | 团队成员列表；每人目标摘要；风险标记(可选) | 点评；退回修改(可选)；导出 | 成员, 目标数量, 权重合计, 进度 | 仅团队可见；点评留痕 | — | Goal(读), Employee(读) | EX0001 |
| RQ0049 | PG0049 | 绩效评估(自评/上级评) | 员工端-自评表 | 评分项/评语；目标回顾；附件 | 保存；提交；导出(可选) | 评分项, 自评得分(可选), 自评总结, 佐证附件 | 提交后锁定；评分范围校验 | 评估状态：未提交/已提交/已完成 | Review(读写), Goal(读) | EX0001,EX0003 |
| RQ0050 | PG0050 | 绩效评估(自评/上级评) | 经理端-评估表 | 员工自评内容；评分项；评语；结果预览 | 保存；提交；退回(可选)；导出 | 评分项, 经理评分, 经理评语, 结果等级(可选) | 提交后锁定；退回需原因 | — | Review(读写) | EX0001 |
| RQ0051 | PG0051 | 绩效结果归档/查看 | HR端-结果汇总页 | 分布图(可选)；结果列表；筛选(组织/等级) | 导出；批量确认(可选)；归档 | 员工, 等级, 得分, 评语摘要, 状态 | 导出字段权限；归档后不可修改 | — | PerformanceResult(读写) | EX0001 |

## 前端实现方案
- 路由与菜单：按 PageID 建路由与菜单分组，详情/创建页按列表页入口跳转。
- 页面结构：以需求中的“页面/区块”为信息架构，表单/表格字段由页面字段表驱动渲染。
- 按钮与权限：按钮集合以“按钮/操作”为准，按钮级权限点从按钮字典同步；字段级权限动态隐藏/脱敏。
- 交互校验：前端执行必填/格式/枚举校验，并在提交时提示后端返回的业务校验错误。
- 导入/导出：统一上传/导出组件；大结果集提示异步导出。
页面清单：
- PG0045 绩效周期管理（列表页）：周期列表；状态；覆盖范围
- PG0046 绩效周期管理（创建/编辑页）：周期基本信息；参与范围；流程节点配置；评估表模板
- PG0047 目标管理(KPI/OKR)（员工端-目标列表）：当前周期目标列表；权重合计提示；对齐关系(可选)
- PG0048 目标管理(KPI/OKR)（经理端-团队目标视图）：团队成员列表；每人目标摘要；风险标记(可选)
- PG0049 绩效评估(自评/上级评)（员工端-自评表）：评分项/评语；目标回顾；附件
- PG0050 绩效评估(自评/上级评)（经理端-评估表）：员工自评内容；评分项；评语；结果预览
- PG0051 绩效结果归档/查看（HR端-结果汇总页）：分布图(可选)；结果列表；筛选(组织/等级)

## 后端实现方案
- 领域对象（建议）：PerformanceCycle、Goal、Review、PerformanceResult
- API 设计：按页面“按钮/操作”映射 CRUD/状态变更/导入导出/审批动作；列表页必须支持分页与多条件筛选。
- 校验与规则：后端强校验业务规则与并发版本（见下方“关键规则/异常”）。
- 权限与审计：RBAC + 组织范围（行级）+ 字段级权限；关键写操作写入审计日志。
- 幂等与一致性：对导入/批量操作提供幂等 token；审批/状态变更防重。

## 状态机
- PerformanceCycle(绩效周期)
  - 未开始 -> 进行中（操作：发布周期；角色：HR/经理/员工）
  - 进行中 -> 校准中(可选)/待确认（操作：提交自评/上级评；角色：HR/经理/员工）
  - 待确认 -> 已完成（操作：员工确认/申诉(可选)；角色：HR/经理/员工）
  - 已完成 -> 已完成（操作：归档/导出；角色：HR/经理/员工）

## 模块联动
- LK0005：上游 M07 绩效管理 -> M10 AI 能力中心；触发=绩效结果归档；读写=读: PerformanceResult用于风险/建议；规则=V3离职风险可引用绩效下降趋势(可解释)

## 关键规则
- 周期不可重叠(同人群)；发布后关键参数锁定(可选)
- 日期逻辑校验；范围内人员冻结快照(可选)
- 权重合计=100%(可配)；截止日期在周期内
- 仅团队可见；点评留痕
- 提交后锁定；评分范围校验
- 提交后锁定；退回需原因
- 导出字段权限；归档后不可修改

## 异常场景
- EX0001：越权访问/返回敏感字段（用户无行级或字段级权限）
- EX0003：必填字段缺失（提交时必填为空）

## 验收与测试要点
- 发布后员工/经理看到对应待办；结束后归档可查
- 发布后自动生成个人目标/评估任务(按配置)
- 提交后经理可评审；目标在评估表中自动展示
- 经理只能看自己团队，且不可越权导出敏感字段
- 提交后经理端出现待办；员工不可再编辑
- 提交后结果进入待确认或完成状态，并可在员工档案查看
- 归档后员工档案可查看历史绩效
